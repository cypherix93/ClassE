var AngularApp=angular.module("AngularApp",["ngSanitize","ngAnimate","ngMessages","ui.router","ui.bootstrap","toastr"]);AngularApp.config(["$httpProvider",function(e){e.defaults.withCredentials=!0,e.interceptors.push(["$location",function(e){return{responseError:function(t){404===t.status&&e.path("/error/404")}}}])}]),AngularApp.config(["toastrConfig",function(e){e.autoDismiss=!0,e.positionClass="toast-bottom-center",e.preventOpenDuplicates=!0}]),AngularApp.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,n){n.html5Mode(!1),e.state("home",{url:"/",templateUrl:"views/home/index.html"}),e.state("error",{url:"/error/:status",templateUrl:function(e){return"views/error/"+e.status+".html"}})}]),AngularApp.run(["$rootScope","ConfigSvc","IdentitySvc","AuthSvc","ModalSvc",function(e,t,n,o,r){t.getAppMeta().then(function(t){e.AppMeta={Name:t.data.name,Version:t.data.version,Description:t.data.description,Copyright:t.data.copyright,Authors:t.data.authors}}),e.PageName="Home",e.IdentitySvc=n,e.AuthSvc=o,e.ModalSvc=r,o.bootstrapSessionUser(),r.initGlobalModals()}]),AngularApp.service("AuthSvc",["$q","$window","ApiSvc","IdentitySvc",function(e,t,n,o){var r=this;r.bootstrapSessionUser=function(){n.get("/auth/me").success(function(e){e.success&&(o.currentUser=e.data)})},r.loginUser=function(r,s){var a=e.defer();return n.post("/auth/login",{email:r,password:s}).success(function(e){e.success?(o.currentUser=e.data,t.sessionStorage.token=o.currentUser.token):delete t.sessionStorage.token,a.resolve(e)}),a.promise},r.logoutUser=function(){var r=e.defer();return n.post("/auth/logout",{logout:!0}).success(function(e){e.success&&(delete o.currentUser,delete t.sessionStorage.token),r.resolve(e)}),r.promise}}]),AngularApp.service("IdentitySvc",function(){var e=this;e.currentUser=void 0,e.isAuthenticated=function(){return!!e.currentUser}}),AngularApp.service("ApiSvc",["$http","ConstantsSvc",function(e,t){var n=this,o=t.apiBaseUrl,r=function(){for(var t=0;t<arguments.length;t++){var r=arguments[t];n[r]=function(t){return function(n,r){return e[t](o+n,r)}}(r)}},s=function(){for(var t=0;t<arguments.length;t++){var r=arguments[t];n[r]=function(t){return function(n,r,s){return e[t](o+n,r,s)}}(r)}};r("get","delete","head","jsonp"),s("post","put","patch")}]),AngularApp.service("ModalSvc",["$q","$http","$compile","$rootScope",function(e,t,n,o){var r=this,s=function(e,t){var n=this;n.element=e,n.state="default",n.onOpen=t.onOpen,n.onClose=t.onClose,n.element.modal({show:!1}),n.element.width(t.width),n.element.on("show",function(){n.element.css("margin-left",-(n.element.width()/2)),n.onOpen&&n.onOpen()}),n.element.on("hidden",function(){n.onClose&&n.onClose()}),n.open=function(){n.element.modal("show")},n.close=function(){n.element.modal("hide")}};r.createModal=function(r,a){var i=e.defer();return t.get(r).success(function(e){var t=angular.element(e),r=o.$new(!0);n(t)(r),angular.element("#content-container").append(t);var u=new s(t,a||{width:600});i.resolve(u)}),i.promise},r.modals={},r.waitUntilReady=function(t){var n=e.defer(),s=o.$watch(function(){return!!r.modals[t]},function(){n.resolve(r.modals[t]),s()});return n.promise},r.initGlobalModals=function(){r.createModal("views/_shared/auth/login.html").then(function(e){r.modals.login=e})}}]),AngularApp.service("ConfigSvc",["$http",function(e){var t=this;t.getAppMeta=function(){return e.get("angular/meta.json")}}]),AngularApp.service("ConstantsSvc",function(){var e=this;e.apiBaseUrl="http://localhost:3960"}),AngularApp.controller("LoginModalCtrl",["$scope","AuthSvc","IdentitySvc","ModalSvc","toastr",function(e,t,n,o,r){var s;o.waitUntilReady("login").then(function(t){s=t,s.onClose=function(){delete e.email,delete e.password}}),e.login=function(){return e.email&&e.password?void t.loginUser(e.email,e.password).then(function(e){return e.success?(s.close(),void r.success("Welcome back "+n.currentUser.email)):void r.error(e.message)}):void r.error("Both email and password needs to be provided.")}}]);
//# sourceMappingURL=angular-bundle.min.js.map
