var AngularApp=angular.module("AngularApp",["ngSanitize","ngAnimate","ngMessages","ui.router","ui.bootstrap","toastr"]);AngularApp.config(["$httpProvider",function(e){e.defaults.withCredentials=!0,e.interceptors.push(["$location",function(e){return{responseError:function(t){404===t.status&&e.path("/error/404")}}}])}]),AngularApp.config(["toastrConfig",function(e){e.autoDismiss=!0,e.positionClass="toast-bottom-center",e.preventOpenDuplicates=!0}]),AngularApp.config(["$stateProvider","$urlRouterProvider","$locationProvider",function(e,t,n){n.html5Mode(!1),e.state("home",{url:"/",templateUrl:"views/home/index.html"}),e.state("error",{url:"/error/:status",templateUrl:function(e){return"views/error/"+e.status+".html"}}),e.state("login",{url:"/login",templateUrl:"views/auth/login.html"}),e.state("register",{url:"/register",templateUrl:"views/auth/register.html"})}]),AngularApp.run(["$rootScope","ConfigSvc","IdentitySvc","AuthSvc","ModalSvc",function(e,t,n,r,o){t.getAppMeta().then(function(t){e.AppMeta={Name:t.data.name,Version:t.data.version,Description:t.data.description,Copyright:t.data.copyright,Authors:t.data.authors}}),e.PageName="Home",e.IdentitySvc=n,e.AuthSvc=r,e.ModalSvc=o,r.bootstrapSessionUser(),o.initGlobalModals()}]),AngularApp.service("AuthSvc",["$q","$window","ApiSvc","IdentitySvc",function(e,t,n,r){var o=this;o.bootstrapSessionUser=function(){n.get("/auth/me").success(function(e){e.success&&(r.currentUser=e.data)})},o.registerUser=function(t){var r=e.defer();return n.post("/auth/register",t).success(function(e){r.resolve(e)}),r.promise},o.loginUser=function(o,s){var i=e.defer();return n.post("/auth/login",{email:o,password:s}).success(function(e){e.success?(r.currentUser=e.data,t.sessionStorage.token=r.currentUser.token):delete t.sessionStorage.token,i.resolve(e)}),i.promise},o.logoutUser=function(){var o=e.defer();return n.post("/auth/logout",{logout:!0}).success(function(e){e.success&&(delete r.currentUser,delete t.sessionStorage.token),o.resolve(e)}),o.promise}}]),AngularApp.service("IdentitySvc",function(){var e=this;e.currentUser=void 0,e.isAuthenticated=function(){return!!e.currentUser}}),AngularApp.service("ApiSvc",["$http","ConstantsSvc",function(e,t){var n=this,r=t.apiBaseUrl,o=function(){for(var t=0;t<arguments.length;t++){var o=arguments[t];n[o]=function(t){return function(n,o){return e[t](r+n,o)}}(o)}},s=function(){for(var t=0;t<arguments.length;t++){var o=arguments[t];n[o]=function(t){return function(n,o,s){return e[t](r+n,o,s)}}(o)}};o("get","delete","head","jsonp"),s("post","put","patch")}]),AngularApp.service("ModalSvc",["$q","$http","$compile","$rootScope",function(e,t,n,r){var o=this,s=function(e,t){var n=this;n.element=e,n.state="default",n.onOpen=t.onOpen,n.onClose=t.onClose,n.element.modal({show:!1}),n.element.width(t.width),n.element.on("show",function(){n.element.css("margin-left",-(n.element.width()/2)),n.onOpen&&n.onOpen()}),n.element.on("hidden",function(){n.onClose&&n.onClose()}),n.open=function(){n.element.modal("show")},n.close=function(){n.element.modal("hide")}};o.createModal=function(o,i){var a=e.defer();return t.get(o).success(function(e){var t=angular.element(e),o=r.$new(!0);n(t)(o),angular.element("#content-container").append(t);var u=new s(t,i||{width:600});a.resolve(u)}),a.promise},o.modals={},o.waitUntilReady=function(t){var n=e.defer(),s=r.$watch(function(){return!!o.modals[t]},function(){n.resolve(o.modals[t]),s()});return n.promise},o.initGlobalModals=function(){}}]),AngularApp.service("ConfigSvc",["$http",function(e){var t=this;t.getAppMeta=function(){return e.get("angular/meta.json")}}]),AngularApp.service("ConstantsSvc",function(){var e=this;e.apiBaseUrl="http://localhost:3960"}),AngularApp.controller("LoginCtrl",["$scope","$state","AuthSvc","IdentitySvc","ModalSvc","toastr",function(e,t,n,r,o,s){e.login=function(){return e.email&&e.password?void n.loginUser(e.email,e.password).then(function(e){return e.success?(t.go("home"),void s.success("Welcome back "+r.currentUser.email)):void s.error(e.message)}):void s.error("Both email and password needs to be provided.")}}]),AngularApp.controller("RegisterCtrl",["$scope","$state","AuthSvc","IdentitySvc","ModalSvc","toastr",function(e,t,n,r,o,s){e.user={},e.register=function(){return e.user.email&&e.user.password?void n.registerUser(e.user).then(function(e){return e.success?(t.go("login"),void s.success("Thanks for signing up "+r.currentUser.email)):void s.error(e.message)}):void s.error("Both email and password needs to be provided.")}}]);
//# sourceMappingURL=angular-bundle.min.js.map
